"0","# Hàm trợ giúp để hiển thị ma trận nhầm lẫn đẹp hơn"
"0","print_cm <- function(cm_object, model_name) {"
"0","  cat(""\nMa trận nhầm lẫn cho:"", model_name, ""\n"")"
"0","  # print(cm_object) # In bản đầy đủ"
"0","  "
"0","  # Trích xuất bảng ma trận"
"0","  cm_table <- cm_object$table"
"0","  "
"0","  # Trích xuất các số liệu thống kê tổng thể và theo lớp"
"0","  overall_stats <- cm_object$overall"
"0","  byclass_stats <- cm_object$byClass"
"0","  "
"0","  # In tóm tắt"
"0","  cat("" Accuracy:"", round(overall_stats[""Accuracy""], 4), ""\n"")"
"0","  cat("" Kappa:"", round(overall_stats[""Kappa""], 4), ""\n"")"
"0","  cat("" Sensitivity (Recall for class 1):"", round(byclass_stats[""Sensitivity""], 4), ""\n"")"
"0","  cat("" Specificity (Recall for class 0):"", round(byclass_stats[""Specificity""], 4), ""\n"")"
"0","  cat("" Precision (for class 1):"", round(byclass_stats[""Precision""], 4), ""\n"")"
"0","  cat("" F1-Score (for class 1):"", round(byclass_stats[""F1""], 4), ""\n"")"
"0","  cat("" Balanced Accuracy:"", round(byclass_stats[""Balanced Accuracy""], 4), ""\n"")"
"0","  "
"0","  # Sử dụng kable để hiển thị ma trận đẹp hơn"
"0","  cm_df <- as.data.frame(cm_table)"
"0","  cm_pivot <- tidyr::pivot_wider(cm_df, names_from = Prediction, values_from = Freq)"
"0","  "
"0","  kable(cm_pivot, caption = paste(""Confusion Matrix:"", model_name)) %>%"
"0","    kable_styling(bootstrap_options = c(""striped"", ""hover"", ""condensed""), full_width = F) %>%"
"0","    add_header_above(c("" "" = 1, ""Predicted"" = ncol(cm_pivot)-1)) %>%"
"0","    column_spec(1, bold = T) %>%"
"0","    footnote(general = ""Rows: Actual, Columns: Predicted"") %>% print()"
"0","}"
"0",""
"0","# Sử dụng caret::confusionMatrix (vì nó cung cấp nhiều số liệu)"
"0","# Lưu ý: 'positive' class là ""1"" (vỡ nợ)"
"0","cm_lr <- confusionMatrix(data = pred_class_lr, reference = test_data$default.payment.next.month, positive = ""1"")"
"0","cm_rf <- confusionMatrix(data = pred_class_rf, reference = test_data$default.payment.next.month, positive = ""1"")"
"0","cm_xgb <- confusionMatrix(data = pred_class_xgb, reference = test_data$default.payment.next.month, positive = ""1"")"
"0",""
"0","print_cm(cm_lr, ""Logistic Regression"")"
"1","
Ma trận nhầm lẫn cho: Logistic Regression 
 Accuracy: 0.6714 
 Kappa: 0.2697 
 Sensitivity (Recall for class 1): 0.6845 
 Specificity (Recall for class 0): 0.6677 
 Precision (for class 1): 0.3692 
 F1-Score (for class 1): 0.4797 
 Balanced Accuracy: 0.6761 
"
